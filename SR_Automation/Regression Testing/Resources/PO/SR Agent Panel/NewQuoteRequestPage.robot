*** Settings ***
Library                                                     Browser
Library                                                     ../../../../SR_Custom_Library/SrCustomLib.py
Library                                                     Collections

*** Variables ***
${Initiate_Application_Text}                                xpath=//p[contains(@data-qa,'Initiate Application')]
${Select_Product_Tab}                                       xpath=//span[contains(@class, 'MuiStepLabel-label Mui-active') and normalize-space() = "Select Product"]
${NoProductAdded_Text}                                      No Product Added
${Message}                                                  Select product(s) to proceed further

&{Select_Insustry_Type}                                     All=//button[@data-qa="All"]                                                                                                                                           Cannabis=//button[@data-qa="Cannabis"]                                                                                                                                 Real_Estate=//button[@data-qa="Real Estate"]                                                                                                                           Restaurant=//button[@data-qa="Restaurant"]                                                                                                                             Contractors=//button[@data-qa="Contractors"]                                                                                                                           Technology=//button[@data-qa="Technology"]

&{Select_Products}                                          Residential_Flood=//div[@data-qa="Flood Insurance: Residential"][1]                                                                                                    Commercial_Flood=//div[@data-qa="Flood Insurance: Commercial"][1]                                                                                                      Cyber=//div[@data-qa="Cyber Insurance"][1]                                                                                                                             Workers_Comp=//div[@data-qa="Workers Compensation"][1]                                                                                                                 Cannabis_Workers_Comp=//div[@data-qa="Cannabis Workers Compensation"][1]                                                                                               Cannabis_Gen_L=//div[@data-qa="Cannabis: General Liability"][1]                                                                                                        Cannabis_Prod_L=//div[@data-qa="Cannabis: Product Liability"][1]                                                                                                       Cannabis_Prop_L=//div[@data-qa="Cannabis: Property Liability"][1]                                                                                                      Commercial_Gen_L=//div[@data-qa="Commercial General Liability: GL"][1]                                                                                                 BuildersRisk_Residential=//div[@data-qa="Builders Risk: Residential"][1]

&{Products_Text}                                            Residential_Flood=Flood Insurance: Residential                                                                                                                         Commercial_Flood=Flood Insurance: Commercial                                                                                                                           Cyber=Cyber Insurance                                                                                                                                                  Workers_Comp=Workers Compensation                                                                                                                                      Cannabis_Workers_Comp=Cannabis Workers Compensation                                                                                                                    Cannabis_Gen_L=Cannabis: General Liability                                                                                                                             Cannabis_Prod_L=Cannabis: Product Liability                                                                                                                            Cannabis_Prop_L=Cannabis: Property Liability                                                                                                                           Commercial_Gen_L=Commercial General Liability: GL                                                                                                                      BuildersRisk_Residential=Builders Risk: Residential

&{Product_Selected}                                         Residential_Flood=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[contains(@class, 'box MuiBox-root css')]//*[@data-qa="Flood Insurance: Residential"]                                                                                                                                                                    Commercial_Flood=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[contains(@class, 'box MuiBox-root css')]//*[@data-qa="Flood Insurance: Commercial"]                                                                                                                                                                     Cyber=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[contains(@class, 'box MuiBox-root css')]//*[@data-qa="Cyber Insurance"]                                                                                                                                                                                             Workers_Comp=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[contains(@class, 'box MuiBox-root css')]//*[@data-qa="Workers Compensation"]                                                                                                                                                                                       Cannabis_Workers_Comp=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[contains(@class, 'box MuiBox-root css')]//*[@data-qa="Cannabis Workers Compensation"]                                                                                                                                                                   Cannabis_Gen_L=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[contains(@class, 'box MuiBox-root css')]//*[@data-qa="Cannabis: General Liability"]                                                                                                                                                                     Cannabis_Prod_L=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[contains(@class, 'box MuiBox-root css')]//*[@data-qa="Cannabis: Product Liability"]                                                                                                                                                                     Cannabis_Prop_L=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[contains(@class, 'box MuiBox-root css')]//*[@data-qa="Cannabis: Property Liability"]                                                                                                                                                                    Commercial_Gen_L=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[contains(@class, 'box MuiBox-root css')]//*[@data-qa="Commercial General Liability: GL"]                                                                                                                                                                BuildersRisk_Residential=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[contains(@class, 'box MuiBox-root css')]//*[@data-qa="Builders Risk: Residential"]
#//*[@class='MuiBox-root css-1sj3cvo']

${Product_Loader}                                           xpath=//div[@aria-label='animation']//*[name()='svg']

#&{Selected_Products}                                        Residential_Flood=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[@class='box MuiBox-root css-18x45nb']//*[@data-qa='Flood Insurance: Residential']                                                                                                                                                                         Commercial_Flood=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[@class='box MuiBox-root css-18x45nb']//*[@data-qa='Flood Insurance: Commercial']                                                                                                                                                                          Cyber=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[@class='box MuiBox-root css-18x45nb']//*[@data-qa='Cyber Insurance']                                                                                                                                                                                      Workers_Comp=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[@class='box MuiBox-root css-18x45nb']//*[@data-qa='Workers Compensation']                                                                                                                                                                                 Cannabis_Workers_Comp=//p[@data-qa=" Commercial_Gen_LInitiate Application"]/ancestor::div[@class='box MuiBox-root css-18x45nb']//*[@data-qa='Cannabis Workers Compensation']                                                                                                                                                            Cannabis_Gen_L=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[@class='box MuiBox-root css-18x45nb']//*[@data-qa='Cannabis: General Liability']                                                                                                                                                                          Cannabis_Prod_L=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[@class='box MuiBox-root css-18x45nb']//*[@data-qa='Cannabis: Product Liability']                                                                                                                                                                          Cannabis_Prop_L=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[@class='box MuiBox-root css-18x45nb']//*[@data-qa='Cannabis: Property Liability']                                                                                                                                                                         Commercial_Gen_L=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[@class='box MuiBox-root css-18x45nb']//*[@data-qa='Commercial General Liability: GL']                                                                                                                                                                     BuildersRisk_Residential=//p[contains(@data-qa, "Initiate Application")]/ancestor::div[@class='box MuiBox-root css-18x45nb']//*[@data-qa='Builders Risk: Residential']

&{Select_Carriers}                                          At-Bay=//p[@data-qa='At-Bay']                                                                                                                                          Cowbell=//p[@data-qa='Cowbell P100']                                                                                                                                   Dual=//p[contains(@data-qa, 'DUAL')]                                                                                                                                   Neptune=//p[@data-qa='Neptune']                                                                                                                                        Poulton=//p[@data-qa='Poulton']                                                                                                                                        Blitz=//p[@data-qa='Blitz']                                                                                                                                            Argo=//p[@data-qa='Argo']                                                                                                                                              Brit=//p[@data-qa='Brit']                                                                                                                                              Chaucer=//p[@data-qa='Chaucer']                                                                                                                                        Chubb=//p[@data-qa='Chubb']                                                                                                                                            Hiscox=//p[@data-qa='Hiscox']                                                                                                                                          Vave=//p[@data-qa='Vave']                                                                                                                                              AmTrust=//p[@data-qa='AmTrust']                                                                                                                                        CoveRisk=//p[@data-qa='CoveRisk']                                                                                                                                      Employers=//p[@data-qa='Employers']                                                                                                                                    HighView=//p[@data-qa='HighView National Insurance']                                                                                                                   CoverWhale=//p[@data-qa='CoverWhale']                                                                                                                                  Canngen=//p[@data-qa='Canngen']                                                                                                                                        Kinsale=//p[@data-qa='Kinsale']                                                                                                                                        HartFord=//p[@data-qa='HartFord']                                                                                                                                      certain_A=//p[@data-qa='certain “a” rated underwriters g *']

${Account_Name}                                             xpath=//div[@data-qa="accountName"]//input[@name="accountName" and @type="text"]

#&{Comp_Names}                                               Residential_Flood=Test_ResFlood_U1                                                                                                                                     Commercial_Flood=Test_CommFlood_U1                                                                                                                                     Cyber=Test_Cyber_U1                                                                                                                                                    Workers_Comp=Test_WC_U1                                                                                                                                                Cannabis_Workers_Comp=Test_CWC_U1                                                                                                                                      Cannabis_Gen_L=Test_CGL_U1                                                                                                                                             Cannabis_Prod_L=Test_CGlPordL_U1                                                                                                                                       Cannabis_Prop_L=Test_CGlPropL_U1                                                                                                                                       Commercial_Gen_L=Test_CommGL_U1                                                                                                                                        Multi_Products=Test_MultiProduct_U1

${Multi_Comp_Names}                                         Test_Multi_Comp_U1

${States_Dropdown}                                          xpath=//div[@data-qa="state"]

&{Select_State}                                             AL=//li[@data-value="Alabama"]                                                                                                                                         AK=//li[@data-value="Alaska"]                                                                                                                                          AZ=//li[@data-value="Arizona"]                                                                                                                                         AR=//li[@data-value="Arkansas"]                                                                                                                                        CA=//li[@data-value="California"]                                                                                                                                      CO=//li[@data-value="Colorado"]                                                                                                                                        CT=//li[@data-value="Connecticut"]                                                                                                                                     DE=//li[@data-value="Delaware"]                                                                                                                                        DC=//li[@data-value="District of Columbia"]                                                                                                                            FL=//li[@data-value="Florida"]                                                                                                                                         GA=//li[@data-value="Georgia"]                                                                                                                                         HI=//li[@data-value="Hawaii"]                                                                                                                                          ID=//li[@data-value="Idaho"]                                                                                                                                           IL=//li[@data-value="Illinois"]                                                                                                                                        IN=//li[@data-value="Indiana"]                                                                                                                                         IA=//li[@data-value="Iowa"]                                                                                                                                            KS=//li[@data-value="Kansas"]                                                                                                                                          KY=//li[@data-value="Kentucky"]                                                                                                                                        LA=//li[@data-value="Louisiana"]                                                                                                                                       ME=//li[@data-value="Maine"]                                                                                                                                           MD=//li[@data-value="Maryland"]                                                                                                                                        MA=//li[@data-value="Massachusetts"]                                                                                                                                   MI=//li[@data-value="Michigan"]                                                                                                                                        MN=//li[@data-value="Minnesota"]                                                                                                                                       MS=//li[@data-value="Mississippi"]                                                                                                                                     MO=//li[@data-value="Missouri"]                                                                                                                                        MT=//li[@data-value="Montana"]                                                                                                                                         NE=//li[@data-value="Nebraska"]                                                                                                                                        NV=//li[@data-value="Nevada"]                                                                                                                                          NH=//li[@data-value="New Hampshire"]                                                                                                                                   NJ=//li[@data-value="New Jersey"]                                                                                                                                      NM=//li[@data-value="New Mexico"]                                                                                                                                      NY=//li[@data-value="New York"]                                                                                                                                        NC=//li[@data-value="North Carolina"]                                                                                                                                  ND=//li[@data-value="North Dakota"]                                                                                                                                    OH=//li[@data-value="Ohio"]                                                                                                                                            OK=//li[@data-value="Oklahoma"]                                                                                                                                        OR=//li[@data-value="Oregon"]                                                                                                                                          PA=//li[@data-value="Pennsylvania"]                                                                                                                                    PR=//li[@data-value="Puerto Rico"]                                                                                                                                     RI=//li[@data-value="Rhode Island"]                                                                                                                                    SC=//li[@data-value="South Carolina"]                                                                                                                                  SD=//li[@data-value="South Dakota"]                                                                                                                                    TN=//li[@data-value="Tennessee"]                                                                                                                                       TX=//li[@data-value="Texas"]                                                                                                                                           UT=//li[@data-value="Utah"]                                                                                                                                            VT=//li[@data-value="Vermont"]                                                                                                                                         VA=//li[@data-value="Virginia"]                                                                                                                                        VI=//li[@data-value="Virgin Islands"]                                                                                                                                  WA=//li[@data-value="Washington"]                                                                                                                                      WV=//li[@data-value="West Virginia"]                                                                                                                                   WI=//li[@data-value="Wisconsin"]                                                                                                                                       WY=//li[@data-value="Wyoming"]

${StartApplication_Button}                                  xpath=//button[text()='Start Application']
${Product_Not_Available_Alert}                              xpath=//div[@role="alert"]//div[@class="MuiAlert-message css-1xsto0d"]/span

*** Keywords ***
Verify Page loaded
    Wait For Elements State                                 ${Select_Product_Tab}
	Verify No Product Added message

Verify No Product Added message
	Get Element By                                          text                                            ${NoProductAdded_Text}
	Get Element By                                          text                                            ${Message}

Verify Initiate Application Section Loaded
	Wait For Elements State                                 ${Initiate_Application_Text}

Select Industry Types
	[Arguments]                                             ${Industry_Type}
	${industryType_ID}                                      Get From Dictionary                             ${Select_Insustry_Type}     ${Industry_Type}
	Click                                                   ${industryType_ID}
	
Select Product
	[Arguments]                                             ${Product}
	Scroll To Element                                       ${Select_Products.${Product}}
	Click                                                   ${Select_Products.${Product}}
	Wait For Elements State                                 ${Product_Selected.${product}}
	Browser.Wait For Condition    Text                      ${Product_Selected.${product}}                  contains                    ${Products_Text.${product}}

Select Multiple Products
	[Arguments]                                             @{Products}
	FOR    ${product}   IN    @{Products}
	    ${productID}=                                       Get From Dictionary                             ${Select_Products}          ${product}
	    Scroll To Element                                   ${productID}
	    Click                                               ${productID}
	    Wait For Elements State                             ${Product_Selected.${product}}
		Browser.Wait For Condition    Text                  ${Product_Selected.${product}}                  contains                    text=${Products_Text.${product}}
		Log                                                 ${Products_Text.${product}}
	END

Open State Dropdown and select State
	[Arguments]                                             ${state}
	Click                                                   ${States_Dropdown}
	Select State                                            ${state}

Select State
	[Arguments]                                             ${state}
	${state_ID}                                             Get From Dictionary                             ${Select_State}             ${state}
	Scroll To Element                                       ${state_ID}
	Click                                                   ${state_ID}
	Verify Product Loader

Verify Product Loader
    Wait For Elements State                                 ${Product_Loader}                               state=detached

Select Carriers
	[Arguments]                                             @{carriers}
	FOR    ${carrier}    IN    @{carriers}
	${carrier_ID}                                           Get From Dictionary                             ${Select_Carriers}          ${carrier}
	    Click                                               ${carrier_ID}
	END
	
Enter Insured Company Name
	[Arguments]                                             ${Comp_Name}
	Fill Text                                               ${Account_Name}                                 ${Comp_Name}

Click Start Application
    Wait For Elements State                                 ${StartApplication_Button}
	Click                                                   ${StartApplication_Button}
